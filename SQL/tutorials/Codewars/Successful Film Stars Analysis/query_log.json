[{"query_string": "\nwith \nmissing_films as (\nselect film_id,'where inventory_id not in (select inventory_id from rental)'\nfrom inventory \nwhere inventory_id not in (select inventory_id from rental)\ngroup by 1\n\nunion\n  \nselect film_id ,'where film_id not in (select film_id from inventory) '\nfrom film \nwhere film_id not in (select film_id from inventory) \ngroup by 1\n)\n\n,actor_test as \n(\nselect *\nfrom \n(select \n       actor_id,film_id,row_number() over(partition by actor_id) rn\nfrom \n      film_actor\ngroup by \n      actor_id,film_id) q where rn>=1\n)\n \n \n,films_rented_more_then_seven_times as (\nselect i.film_id,count(r.rental_id) rental_times\nfrom inventory i\ninner join rental r USING(inventory_id )\nwhere film_id in (select film_id from actor_test) \n    and film_id not in (select film_id from missing_films)\ngroup by i.film_id \nhaving count(distinct r.rental_id)>=7\norder by 2 desc\n) \n\n,not_rental_actors as (\nselect actor_id\nfrom film_actor \nwhere film_id in (select film_id from missing_films)\ngroup by actor_id\n)\n\n,res as (\nselect * \nfrom\n(select \n       actor_id\nfrom \n      film_actor\nwhere film_id in (select film_id from films_rented_more_then_seven_times)\nand actor_id not in (select actor_id from not_rental_actors)\ngroup by \n      actor_id\n having count(distinct film_id)>=1\n ) q \n)\n\nselect *\nfrom res\n", "query_output": [], "query_run_at": "2023-11-23 09:12:56.101634", "table_size": 56, "table_col_sizes": [["actor_id", 164]], "sep_values_freqs": {"actor_id": []}, "table_rows": 0, "table_columns": 1}
]