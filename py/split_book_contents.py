import re

text = '''Оглавление
Предисловие .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 16 Благодарности .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 18 О .книге  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 20 Для .кого .эта .книга .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 20 Структура .издания .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 21 О .коде .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 23 Об .авторе .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 24 Иллюстрация .на .обложке .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 25 От .издательства .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 26
Практическое задание 1. Поиск выигрышной  стратегии в карточной игре Условие .задачи .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 27 Описание .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 28 Глава .1  .Вычисление .вероятностей .с .помощью .Python .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 29 1 1  .Анализ .пространства .элементарных .исходов: .лишенный .уравнений . подход .для .измерения .неопределенности .результатов  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 30 1 1 1  .Анализ .несимметричной .монеты  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 33 1 2  .Вычисление .сложных .вероятностей  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 35 Задача .1  .Анализ .семьи .с .четырьмя .детьми .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 35 Задача .2  .Анализ .множества .бросков .игрального .кубика .  .  .  .  .  .  .  .  .  .  .  . 37
8  Оглавление
Задача .3  .Вычисление .вероятностей .исходов .броска .кубика . . с .помощью .пространств .взвешенных .исходов .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 38 1 3  .Вычисление .вероятностей .по .диапазонам .интервалов .  .  .  .  .  .  .  .  .  .  .  .  .  . 40 1 3 1  .Оценка .крайних .значений .с .помощью .интервального .анализа .  .  .  .  . 40 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 43 Глава .2  .Графическое .отображение .вероятностей .с .помощью .Matplotlib .  .  .  .  .  .  . 44 2 1  .Основные .графики .Matplotlib  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 44 2 2  .Построение .графика .вероятностей .исходов .подбрасывания .монеты  .  .  .  . 49 2 2 1  .Сравнение .нескольких .распределений .вероятностей .исходов . подбрасывания .монеты .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 53 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 60 Глава .3  .Выполнение .случайных .симуляций .в .NumPy  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 61 3 1  .Симулирование .случайных .подбрасываний .монеты .и .бросков .кубика . с .помощью .NumPy .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 62 3 1 1  .Анализ .подбрасываний .монеты .со .смещенным .центром .тяжести .  .  . 64 3 2  .Вычисление .доверительных .интервалов .с .помощью .гистограмм . и .массивов .NumPy .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 66 3 2 1  .Сортировка .схожих .точек .в .столбчатых .диаграммах .  .  .  .  .  .  .  .  .  .  . 70 3 2 2  .Получение .вероятностей .из .гистограмм .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 72 3 2 3  .Сужение .диапазона .высокого .доверительного .интервала .  .  .  .  .  .  .  . 76 3 2 4  .Вычисление .гистограмм .в .NumPy .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 79 3 3  .Использование .доверительных .интервалов .для .анализа .смещенной . колоды .карт  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 81 3 4  .Перетасовка .карт .с .помощью .пермутаций .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 84 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 87 Глава .4  .Решение .практического .задания .1 .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 88 4 1  .Прогнозирование .красных .карт .в .перетасованной .колоде .  .  .  .  .  .  .  .  .  .  .  . 89 4 1 1  .Оценка .вероятности .успеха .стратегии .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 90 4 2  .Оптимизация .стратегий .с .помощью .пространства .исходов .для .колоды . . из .десяти .карт .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 94 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 98
Практическое задание 2. Анализ значимости  переходов по онлайн-объявлениям Условие .задачи .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 99 Описание .набора .данных .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .100 Обзор  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 101 Глава .5  .Базовая .вероятность .и .статистический .анализ .с .помощью .SciPy  .  .  .  .  . 102 5 1  .Изучение .связи .между .данными .и .вероятностью .с .помощью .SciPy .  .  .  .  .  .103
Оглавление  9
5 2  .Среднее .значение .как .мера .центральности  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 108 5 2 1  .Поиск .среднего .распределения .вероятностей  .  .  .  .  .  .  .  .  .  .  .  .  .  . 115 5 3  .Дисперсия .как .мера .рассеяния .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .118 5 3 1  .Определение .дисперсии .распределения .вероятностей .  .  .  .  .  .  .  .  .  .121 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 125 Глава .6  .Составление .прогнозов .с .помощью .центральной .предельной .теоремы . и .SciPy .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .126 6 1  .Управление .нормальным .распределением .с .помощью .SciPy .  .  .  .  .  .  .  .  .  .127 6 1 1  .Сравнение .двух .нормальных .кривых .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .131 6 2  .Определение .среднего .и .дисперсии .совокупности .с .помощью . случайного .моделирования  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 136 6 3  .Составление .прогнозов .на .основе .среднего .и .дисперсии .  .  .  .  .  .  .  .  .  .  .  .  .140 6 3 1  .Вычисление .площади .под .нормальной .кривой .  .  .  .  .  .  .  .  .  .  .  .  .  .  .142 6 3 2  .Интерпретация .вычисленной .вероятности .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .145 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 147 Глава .7  .Проверка .статистических .гипотез .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .148 7 1  .Анализ .расхождения .между .средним .выборки . . и .средним .совокупности  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 149 7 2  .Выуживание .данных: .приход .к .сложным .выводам .из-за .ресэмплинга .  .  .  .155 7 3  .Бутстрэппинг .с .восполнением: .тестирование .гипотез .при .неизвестной . дисперсии .совокупности  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 159 7 4  .Пермутационный .тест: .сравнение .средних .выборок .при .неизвестных . параметрах .совокупности .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .168 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 172 Глава .8  .Анализ .таблиц .с .помощью .Pandas .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .173 8 1  .Сохранение .таблиц .с .помощью .чистого .Python  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 173 8 2  .Изучение .таблиц .с .помощью .Pandas  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 174 8 3  .Извлечение .столбцов .таблицы .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .177 8 4  .Извлечение .строк .таблицы  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 179 8 5  .Изменение .строк .и .столбцов .таблицы  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 181 8 6  .Сохранение .и .загрузка .табличных .данных  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 184 8 7  .Визуализация .таблиц .с .помощью .Seaborn .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .185 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 189 Глава .9  .Решение .практического .задания .2 .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .190 9 1  .Обработка .таблицы .переходов .по .объявлению .в .Pandas .  .  .  .  .  .  .  .  .  .  .  .  .191 9 2  .Вычисление .p-значений .из .разниц .между .средними .значениями .  .  .  .  .  .  .193 9 3  .Определение .статистической .значимости .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .197 9 4  .Поучительная .история .из .реальной .жизни: .41 .оттенок .синего .  .  .  .  .  .  .  .  .199 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 200
10  Оглавление
Практическое задание 3. Отслеживание вспышек  заболеваний по новостным заголовкам Условие .задачи .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .201 Описание .набора .данных .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .201 Обзор  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 202
Глава .10  .Кластеризация .данных .по .группам  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 203 10 1  .Выделение .кластеров .на .основе .центральности  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 204 10 2  .K-средние: .алгоритм .кластеризации .для .группировки .данных . по .K .центральных .групп  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 210 10 2 1  .Кластеризация .по .методу .K-средних . . с .помощью .scikit-learn .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .212 10 2 2  .Выбор .оптимального .K .методом .локтя .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .213 10 3  .Обнаружение .кластеров .по .плотности  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 217 10 4  .DBSCAN: .алгоритм .кластеризации .для .группировки .данных . на .основе .пространственной .плотности .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .221 10 4 1  .Сравнение .DBSCAN .и .метода .K-средних .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .223 10 4 2  .Кластеризация .с .помощью .неевклидовой .метрики  .  .  .  .  .  .  .  .  .  . 224 10 5  .Анализ .кластеров .с .помощью .Pandas .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .228 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 230
Глава .11  .Визуализация .и .анализ .географических .локаций  .  .  .  .  .  .  .  .  .  .  .  .  .  . 231 11 1  .Расстояние .по .ортодромии: .показатель .для .вычисления .расстояния . между .двумя .глобальными .точками .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .232 11 2  .Построение .карт .с .помощью .Cartopy .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .236 11 2 1  .Установка .GEOS .и .Cartopy .вручную .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .236 11 2 2  .Использование .пакетного .менеджера .Conda  .  .  .  .  .  .  .  .  .  .  .  .  .  . 237 11 2 3  .Визуализация .карт  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 238 11 3  .Отслеживание .локаций .с .помощью .GeoNamesCache  .  .  .  .  .  .  .  .  .  .  .  .  . 249 11 3 1  .Получение .информации .о .странах .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .251 11 3 2  .Получение .информации .о .городах .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .253 11 3 3  .Ограничения .библиотеки .GeoNamesCache  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 258 11 4  .Сопоставление .с .названиями .локаций .в .тексте .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .260 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 264
Глава .12  .Решение .практического .задания .3 .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .265 12 1  .Извлечение .локаций .из .заголовков  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 266 11 2  .Визуализация .и .кластеризация .извлеченных .данных . . о .локациях .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .272 12 3  .Формирование .выводов .на .основе .кластеров .локаций .  .  .  .  .  .  .  .  .  .  .  .  .278 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 283
Оглавление  11
Практическое задание 4. Улучшение своего резюме  аналитика данных на основе онлайн-вакансий Условие .задачи .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .285 Описание .набора .данных .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .286 Обзор  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 287
Глава .13  .Измерение .сходства .текстов .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .288 13 1  .Простое .сравнение .текстов  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 289 13 1 1  .Изучение .коэффициента .Жаккара .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  .295 13 1 2  .Замена .слов .численными .значениями  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 297 13 2  .Векторизация .текстов .с .помощью .подсчета .слов .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .302 13 2 1  .Повышение .качества .векторов .частотности .терминов . с .помощью .нормализации  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 305 13 2 2  .Использование .скалярного .произведения .единичных .векторов . для .преобразования .между .параметрами .релевантности .  .  .  .  .  .  .  .  .  .  .  .313 13 3  .Матричное .умножение .для .эффективного .вычисления .сходства  .  .  .  .  . 316 13 3 1  .Базовые .матричные .операции  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 319 13 3 2  .Вычисление .сходства .матриц .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .328 13 4  .Вычислительные .ограничения .матричного .умножения  .  .  .  .  .  .  .  .  .  .  . 330 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 334
Глава .14  .Уменьшение .размерности .матричных .данных  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 335 14 1  .Кластеризация .двухмерных .данных .в .одном .измерении .  .  .  .  .  .  .  .  .  .  .  .337 14 1 1  .Уменьшение .размерности .с .помощью .вращения .  .  .  .  .  .  .  .  .  .  .  .  .341 14 2  .Уменьшение .размерности .с .помощью .PCA .и .scikit-learn .  .  .  .  .  .  .  .  .  .  .  .352 14 3  .Кластеризация .четырехмерных .данных .в .двух .измерениях .  .  .  .  .  .  .  .  .  .359 14 3 1  .Ограничения .PCA .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .365 14 4  .Вычисление .главных .компонент .без .вращения .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .368 14 4 1  .Извлечение .собственных .векторов .с .помощью . . степенного .метода  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 372 14 5  .Эффективное .уменьшение .размерности .с .помощью .SVD . . и .scikit-learn  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 382 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 384
Глава .15  .NLP-анализ .больших .текстовых .наборов .данных  .  .  .  .  .  .  .  .  .  .  .  .  .  . 386 15 1  .Скачивание .дискуссий .онлайн-форумов .с .помощью .scikit-learn .  .  .  .  .  .  .387 15 2  .Векторизация .документов .с .помощью .scikit-learn .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .390 15 3  .Ранжирование .слов .по .числу .вхождений .и .частоте .встречаемости . . в .постах .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .397 15 3 1  .Вычисление .векторов .TF-IDF .с .помощью .scikit-learn  .  .  .  .  .  .  .  . 403 15 4  .Вычисление .сходства .среди .огромных .наборов .документов .  .  .  .  .  .  .  .  .  .406
12  Оглавление
15 5  .Кластеризация .постов .по .темам  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 411 15 5 1  .Анализ .одного .кластера .текстов  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 417 15 6  .Визуализация .кластеров .текстов .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .421 15 6 1  .Использование .подграфиков .для .визуализации .нескольких . облаков .слов .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .426 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 433 Глава .16  .Извлечение .текстов .с .веб-страниц .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .435 16 1  .Структура .HTML-документов .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .436 16 2  .Парсинг .HTML .с .помощью .Beautiful .Soup .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  .444 16 3  .Скачивание .и .парсинг .онлайн-данных .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .452 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 454 Глава .17  .Решение .практического .задания .4 .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .456 17 1  .Извлечение .требуемых .навыков .из .объявлений .о .вакансиях .  .  .  .  .  .  .  .  .457 17 1 1  .Анализ .HTML .на .предмет .описания .навыков  .  .  .  .  .  .  .  .  .  .  .  .  . 459 17 2  .Фильтрация .вакансий .по .релевантности .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .465 17 3  .Кластеризация .навыков .в .релевантных .объявлениях .о .вакансиях .  .  .  .  .  .475 17 3 1  .Группировка .навыков .по .15 .кластерам .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .478 17 3 2  .Анализ .кластеров .технических .навыков .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .484 17 3 3  .Анализ .кластеров .личностных .качеств .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .487 17 3 4  .Анализ .кластеров .при .других .значениях .K  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 489 17 3 5  .Анализ .700 .наиболее .релевантных .вакансий  .  .  .  .  .  .  .  .  .  .  .  .  .  . 494 17 4  .Заключение .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .497 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 497
Практическое задание 5. Прогнозирование будущих знакомств на основе данных  социальной сети Условие .задачи .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .499 Внедрение .алгоритма .рекомендации .друзей .друзей .  .  .  .  .  .  .  .  .  .  .  .  .  .  .500 Прогнозирование .поведения .пользователя .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .501 Описание .набора .данных .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .502 Таблица .Profiles .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .502 Таблица .Observations  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 503 Таблица .Friendships  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 503 Обзор  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 504 Глава .18  .Знакомство .с .теорией .графов .и .анализом .сетей  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 505 18 1  .Использование .базовой .теории .графов .для .ранжирования .сайтов . по .популярности  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 506 18 1 1  .Анализ .веб-сетей .при .помощи .NetworkX  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 509
Оглавление  13
18 2  .Использование .ненаправленных .графов .для .оптимизации .поездки . между .городами .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .519 18 2 1  .Моделирование .сложной .сети .из .городов .и .округов  .  .  .  .  .  .  .  .  . 522 18 2 2  .Вычисление .кратчайшего .времени .следования .между .узлами .  .  .  .528 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 536 Глава .19  .Динамическое .применение .теории .графов .для .ранжирования .узлов . и .анализа .социальных .сетей  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 537 19 1  .Нахождение .центральных .узлов .на .основе .ожидаемого . . трафика .в .сети .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .538 19 1 1  .Измерение .центральности .с .помощью .симуляции .трафика .  .  .  .  .  .542 19 2  .Вычисление .вероятности .путешествия .в .тот .или .иной .город . с .помощью .матричного .умножения  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 544 19 2 1  .Выведение .центральности .PageRank .на .основе . . теории .вероятностей .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .547 19 2 2  .Вычисление .центральности .PageRank .с .помощью .NetworkX .  .  .  .  .552 19 3  .Обнаружение .сообществ .с .помощью .марковской .кластеризации  .  .  .  .  . 555 19 4  .Обнаружение .групп .друзей .в .социальных .сетях .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .570 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 574 Глава .20  .Машинное .обучение .с .учителем .на .основе .сетей .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .575 20 1  .Основы .машинного .обучения .с .учителем  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 576 20 2  .Измерение .точности .прогнозирования .меток .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .585 20 2 1  .Функции .оценки .прогнозов .в .scikit-learn  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 594 20 3  .Оптимизация .эффективности .KNN .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .595 20 4  .Поиск .по .сетке .с .помощью .scikit-learn  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 598 20 5  .Ограничения .алгоритма .KNN .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .603 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 605 Глава .21  .Обучение .линейных .классификаторов .с .помощью .логистической . регрессии .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .607 21 1  .Линейное .деление .клиентов .по .размеру .одежды .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .608 21 2  .Обучение .линейного .классификатора  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 613 21 2 1  .Улучшение .эффективности .перцептрона .с .помощью . . стандартизации .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .622 21 3  .Улучшение .линейной .классификации .с .помощью .логистической . . регрессии .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .626 21 3 1  .Выполнение .логистической .регрессии .для .более .чем . . двух .признаков  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 633 21 4  .Обучение .линейных .классификаторов .с .помощью .scikit-learn .  .  .  .  .  .  .  .634 21 4 1  .Обучение .мультиклассовых .линейных .моделей .  .  .  .  .  .  .  .  .  .  .  .  .637 21 5  .Измерение .важности .признаков .с .помощью .коэффициентов .  .  .  .  .  .  .  .  .641 21 6  .Ограничения .линейных .классификаторов .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .644 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 646
14  Оглавление
Глава .22  .Обучение .нелинейных .классификаторов .с .помощью . . деревьев .решений .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .649 22 1  .Автоматическое .изучение .логических .правил  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 650 22 1 1  .Обучение .вложенной .модели .if/else .на .двух .признаках  .  .  .  .  .  .  . 657 22 1 2  .Выбор .предпочтительного .признака .для .деления .  .  .  .  .  .  .  .  .  .  .  .663 22 1 3  .Обучение .моделей .if/else .с .помощью .более .чем .двух .признаков .  .  .672 22 2  .Обучение .деревьев .решений .с .помощью .scikit-learn .  .  .  .  .  .  .  .  .  .  .  .  .  .  .680 22 2 1  .Изучение .раковых .клеток .на .основе .важности .признаков .  .  .  .  .  .  .687 22 3  .Ограничения .деревьев .решений  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 691 22 4  .Повышение .эффективности .с .помощью .случайных .лесов .  .  .  .  .  .  .  .  .  .  .693 22 5  .Обучение .случайных .лесов .с .помощью .scikit-learn  .  .  .  .  .  .  .  .  .  .  .  .  .  . 698 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 700 Глава .23  .Решение .практического .задания .5 .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .702 23 1  .Изучение .данных .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .703 23 1 1  .Анализ .профилей  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 703 23 1 2  .Анализ .экспериментальных .наблюдений  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 707 23 1 3  .Анализ .таблицы .дружеских .связей .Friendships .  .  .  .  .  .  .  .  .  .  .  .  .  .710 23 2  .Обучение .предиктивной .модели .с .помощью .признаков .сети .  .  .  .  .  .  .  .  .713 23 3  .Добавление .в .модель .признаков .профилей  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 720 23 4  .Оптимизация .эффективности .при .конкретном .наборе .признаков .  .  .  .  .  .726 23 5  .Интерпретация .обученной .модели .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .728 23 5 1  .Почему .столь .важна .обобщаемость .модели .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .732 Резюме  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 733'''



#new_text = ' '.join(['tmp_sep'+i.strip()


for i in text.split('.'):
    if i.strip()!='':
        print(i.strip())
    #if re.findall('[1-23]',i):i+'tmp_sep'

                    


